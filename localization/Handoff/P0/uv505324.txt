	<title>Troubleshooting Power BI Analysis Service Connector</title>
	
	<span style="line-height: 14px; font-family: sans-serif; font-size: 14px; font-style: normal; font-variant: normal;"><span style='line-height: 107%; font-family: "Calibri",sans-serif; font-size: 11pt; mso-ansi-language: EN-US; mso-fareast-font-family: Calibri; mso-bidi-font-family: "Times New Roman"; mso-fareast-language: EN-US; mso-ascii-theme-font: minor-latin; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-theme-font: minor-bidi; mso-bidi-language: AR-SA;'><font face="Times New Roman" size="3"><span style='line-height: 107%; font-family: "Calibri",sans-serif; font-size: 11pt; mso-ansi-language: EN-US; mso-fareast-font-family: Calibri; mso-bidi-font-family: "Times New Roman"; mso-fareast-language: EN-US; mso-ascii-theme-font: minor-latin; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-theme-font: minor-bidi; mso-bidi-language: AR-SA;'><font face="Calibri" size="3"></font></span></font><font face="Times New Roman" size="3"><font face="Calibri" size="3"></font></font><li><font face="Times New Roman" size="3"><font face="Calibri" size="3"><p style="margin: 0in 0in 0pt; line-height: 14.7pt;"><span style='color: black; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: Arial; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri;'><font face="Calibri" size="3">If you're having issues using the Power BI Analysis Services Connector, be sure check out these troubleshooting tips.<br></font><b><br><font face="Calibri" size="3"> Connector installation fails</font></b><font face="Calibri" size="3"> - <i>﻿</i>If you run into issues during the connector installation:</font></span></p><font face="Times New Roman" size="3"></font><font face="Calibri" size="3">1.&nbsp;&nbsp; Check if you can sign in to Power BI with the account you used when configuring the connector.</font><div style="margin: 6pt 0in;"><font face="Calibri" size="3">2.&nbsp;&nbsp; Try connecting to the AS server with Excel or SSMS from the machine you are trying to install the connector on. If this doesn't work, then the connector&nbsp;won't connect either.</font></div><div style="margin: 6pt 0in;"><font face="Calibri" size="3">3.&nbsp;&nbsp; Check if the 'Data Management Gateway Host Service' is running. Restarting the service&nbsp;can sometimes&nbsp;help.</font></div><font face="Times New Roman" size="3"></font><p style="margin: 6pt 0in;"><font face="Calibri"><font size="3"><b><span style='color: black; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: Arial; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri;'><br></span></b></font></font></p></font></font></li><li><font face="Times New Roman" size="3"><font face="Calibri" size="3"><font face="Calibri"><font size="3"><b><span style='color: black; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: Arial; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri;'>Connector configuration gives the following error -</span></b></font></font></font></font></li><li>This error &nbsp;means that your Power BI username does not
match your on-premises username. Hence the effective user name mechanism that
Power BI relies on to connect to the Analysis Services Server could not work. To
fix it, you'll have to ensure you use your work email address with Power BI or
synchronize your on-premises Active Directory with Azure Active Directory. <a href="http://support.powerbi.com/knowledgebase/articles/546004-power-bi-analysis-services-connector-in-depth">Learn more</a> about the Analysis Services Connector Services Connector to understand
the role the effective user name plays &amp; why the Active Director to Azure
Active Directory sync is needed.</li><li>

<strong>﻿</strong>﻿</li><li><font face="Times New Roman" size="3"><font face="Calibri" size="3"><font face="Calibri"><font size="3"><b><span style='color: black; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: Arial; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri;'><span><img src="https://powerbi.uservoice.com/assets/82776010/TShoot_ASConnector_Error.png"></span></span></b></font></font></font></font></li><li><font face="Times New Roman" size="3"><font face="Calibri" size="3"><font face="Calibri"><font size="3"><b><span style='color: black; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: Arial; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri;'><br>Connector installed successfully, but doesn't work with Power BI</span></b><span style='color: black; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: Arial; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri;'>&nbsp;- </span>If you see errors when trying to connect to Analysis Services data through Power BI :</font></font><font face="Times New Roman" size="3"></font><font face="Calibri" size="3">1.&nbsp;&nbsp; If you used an .onmicrosoft.com email address with Power BI, you may need to set up DirSync between your on-premises Active Directory and Azure Active Directory. </font><div style="margin: 6pt 0in;"><font face="Calibri"><font size="3">2.&nbsp;&nbsp; Check if the 'Data Management Gateway Host Service' is running. Restarting the service may help.</font></font></div><div style="margin: 6pt 0in;"><font face="Calibri" size="3">3.&nbsp;&nbsp; Confirm the AS server is running.&nbsp;</font></div><div style="margin: 6pt 0in;"><font face="Calibri" size="3">4.&nbsp;&nbsp; Check in Windows Event Viewer log. You'll see Data Management Gateway under Applications and Services Logs.</font></div><blockquote><span></span><span><img src="https://powerbi.uservoice.com/assets/78792490/DMG_Service.png"></span><br></blockquote><font face="Calibri" size="3"><font face="Times New Roman"></font><p style="margin: 6pt 0in;">If you see the following error:</p><font face="Times New Roman"></font><p style="margin: 0in 0in 0pt 0.25in; line-height: normal;"><span style='color: black; mso-fareast-font-family: "Times New Roman";'>Unable to access the data from Data Management Gateway: System.Runtime.InteropServices.InvalidComObjectException: Failed to load COM interface IMDExternalConnection ---&gt; System.Runtime.InteropServices.COMException: Error HRESULT E_FAIL has been returned from a call to a COM component. at Microsoft.DataTransfer.DIAgentCommon.DataAccess.Msolap.IMDExternalDataChannel.OpenConnection(String in_bstrConnectionString, String in_bstrAuthInfo, Object&amp; out_ppConnection) at Microsoft.DataTransfer.DIAgentCommon.DataAccess.Msolap.MsolapHandler.CheckConnection() ).<!--</span--></span></p><font face="Times New Roman"></font><p style="margin: 6pt 0in;">This means the EffectiveUserName property is not working. This can happen because:</p><ul><li><div style="margin: 6pt 0in;">You are using an .ommicrosoft.com e-mail to login and you don't have your on-premises&nbsp;Active Directory synchronized with Azure Active Directory with DirSync.</div></li><li><div style="margin: 6pt 0in;">You are using a work e-mail address but the username returned by Azure Active Directory doesn't match the username in your on-premises Active Directory.</div></li><li><div style="margin: 6pt 0in;">You are using a work e-mail address, but the domain names in Azure Active Directory and your on-premises Active Directory don't match.&nbsp;&nbsp;</div></li></ul><p style="margin: 6pt 0in;">You can test locally from the computer the AS Connector is installed on:</p></font></font></font><ul><font face="Times New Roman" size="3"><font face="Calibri" size="3"><font face="Calibri" size="3"><li>Using whoami/UPN: From a command prompt, type 'whoami/upn'. If the return result doesn't match the e-mail address used with the Power BI account, the AS Connector won't work</li></font></font><li><font face="Calibri" size="3"><font face="Calibri" size="3">Using SSMS: In SQL Server Management Studio (SSMS), in the connect to server dialog&nbsp;for Analysis Services server, choose 'Options&gt;&gt;' </font><br><font face="Calibri" size="3"><span></span></font><span><img src="https://powerbi.uservoice.com/assets/78799477/TShootASConnector_SSMSConnect.png"></span><br>Then in the Additional Connection Parameters set EffectiveUserName=&lt;work email address used to login to PowerBI&gt; or the result of the whoami/upn). Then click Connect.<span><img src="https://powerbi.uservoice.com/assets/78799492/TShootASConnector_SSMSAddParameters.png"></span><br><span></span></font></li><p></p><font face="Calibri" size="3">If connecting to the Analysis Services Server does not work, then the AS Connector will not work either.</font><span style="line-height: 1.4em; font-family: Calibri; font-size: medium;"><br><p><span style="line-height: 1.4em; font-family: Calibri; font-size: medium;">There are many reasons why this might not work. Multiple domains, asymmetric trust relationships between domains, etc. In all of these cases, if the Analysis Services server cannot resolve the username of the cloud identity (used to log into Power BI), the AS Connector will not work.</span></p><p style="margin: 0in 0in 0pt; line-height: 14.7pt;"><font face="Calibri"><font size="3"><b><span style='color: black; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: Arial; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri;'>Connector installed successfully&nbsp;and reports work, but tiles don't get updated</span></b><span style='color: black; mso-fareast-font-family: "Times New Roman"; mso-bidi-font-family: Arial; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri;'>:</span></font></font></p><font face="Times New Roman" size="3"></font><ol><li><div style="margin: 6pt 0in;"><font face="Calibri" size="3">Power BI automatically updates&nbsp;report tiles connected to an Analysis Services server. The update frequency is every 10 minutes.</font></div></li><font face="Times New Roman" size="3"></font><li><div style="margin: 6pt 0in;"><font face="Calibri" size="3">Check you're able to open the report and see latest data.</font></div></li><font face="Times New Roman" size="3"></font><li><div style="margin: 6pt 0in;"><font face="Calibri" size="3">Check if you're able to pin the visual from Report and check if the latest data is showing in the tile on the dashboard.</font></div></li><font face="Times New Roman" size="3"></font><li><div style="margin: 6pt 0in;"><font face="Calibri" size="3">Start SQL Profiler and check if there are queries being sent to the Analysis Services tabular database.</font></div></li></ol><font face="Times New Roman" size="3"></font><p style="margin: 6pt 0in;"><font face="Calibri" size="3">If you've followed all these steps and are still having problems,&nbsp;click&nbsp;<span><img src="https://powerbi.uservoice.com/assets/78792577/PBI_Support.png"></span><span></span> in the main Power BI page, then click <b>Contact Support.</b> Send us:</font></p><p style="margin: 6pt 0in;"></p><font face="Calibri" size="3"><p style="margin: 6pt 0in;"><font face="Times New Roman"></font></p><ul><li>Any logs that are generated during installation, if there were errors.</li><li>Any error messages you’re seeing (including the Technical Details) during configuration.</li><li>Any errors that&nbsp;appear under Data Management Gateway in Event Viewer.</li><li>Any ‘Audit Failure’ events in the Windows Security log related to the account you’re using to connect to Analysis Services.</li><li>Any errors you see in SQL Profiler while trying to connect from Power BI</li></ul></font></span></font><ul></ul><p><br></p><p></p><p></p><p></p><p></p><div></div></ul></li></span></span>
